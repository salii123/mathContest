angular.module('TestCtrl', []).controller('TestController', function ($scope, socketFactory) {

    var questionsInFrontEnd;
    var roomId = 0;

  //  $scope.users = [
    //    {name: 'user 1', score: 50},
    //    {name: 'user 2', score: 20},
    //    {name: 'user 3', score: 150},
    //    {name: 'user 4', score: 90}
   // ];

    //姓名
     
     socketFactory.on('userName',function(name){
         $scope.user.name = name;
	 });

    $scope.userSubmitAns = function () {
        socketFactory.emit('userAnswer', $scope.userAns);
        $scope.userAns = '';
    };

    socketFactory.emit('userReady', '');

    socketFactory.on('testAddPlayers', function (data) {
        roomId = data.room;
        $scope.uesrQuestions = '请等待别的用户,要集齐4个人测试才开始。' +
        '现在在线人数： ' + data.user //+ ' players in Room: ' + data.room;
    });

    socketFactory.on('testBegin', function (questions) {
        questionsInFrontEnd = questions;
        $scope.uesrQuestions = '测试在5秒后开始！';
    });

   // socketFactory.on('prepareNextQuestion', function () {
    //    $scope.uesrQuestions = 'Next question in 3s...';
    //});

    socketFactory.on('nextQuestion', function (data) {
        $scope.userAnswerStatus = '';
        $scope.uesrQuestions = questionsInFrontEnd[data].num1 +
        questionsInFrontEnd[data].operator + questionsInFrontEnd[data].num2;
    });

    //socketFactory.on('answerRight', function (questions) {
    //    $scope.userAnswerStatus = 'Correct!';
    //});

    socketFactory.on('answerWrong', function (questions) {
        $scope.userAnswerStatus = '答案错误,请重新输入!';
    });

    socketFactory.on('allFinish', function (questions) {
        $scope.uesrQuestions = '题目已答完!';
    });

});